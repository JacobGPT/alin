<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width,initial-scale=1.0">
  <title>Sign In — ALIN</title>
  <meta name="description" content="Sign in to your ALIN account.">
  <link rel="preconnect" href="https://api.fontshare.com" crossorigin>
  <link href="https://api.fontshare.com/v2/css?f[]=satoshi@700,900&f[]=general-sans@400,500,600&display=swap" rel="stylesheet">
  <link href="https://fonts.googleapis.com/css2?family=JetBrains+Mono:wght@400;700&display=swap" rel="stylesheet">
  <link rel="stylesheet" href="styles.css">
</head>
<body>

<script src="shared.js"></script>
<script>document.body.insertAdjacentHTML('afterbegin',getNav('login'));</script>

<section class="page-hero" style="padding-bottom:1.5rem">
  <div class="wrap">
    <div style="animation:rise .6s var(--ease) both">
      <span class="page-hero__overline">Welcome Back</span>
      <h1 class="page-hero__title" data-scramble>Sign in to ALIN</h1>
      <p class="page-hero__desc">Pick up right where you left off.</p>
    </div>
  </div>
</section>

<section class="section" style="padding-top:1rem">
  <div class="wrap">
    <div class="auth-wrap">
      <div class="auth-card reveal-scale">

        <div class="form__alert form__alert--error" id="error"></div>

        <div class="form__group">
          <label class="form__label" for="email">Email</label>
          <input class="form__input" type="email" id="email" placeholder="you@example.com" autocomplete="email">
        </div>

        <div class="form__group">
          <label class="form__label" for="password">Password</label>
          <div class="form__pw-wrap">
            <input class="form__input" type="password" id="password" placeholder="••••••••" autocomplete="current-password">
            <button type="button" class="form__pw-toggle" id="togglePw" aria-label="Toggle password visibility">
              <svg id="eyeIcon" width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M1 12s4-8 11-8 11 8 11 8-4 8-11 8-11-8-11-8z"/><circle cx="12" cy="12" r="3"/></svg>
            </button>
          </div>
        </div>

        <div style="display:flex;justify-content:flex-end;margin-bottom:1.5rem">
          <a href="#" class="link-brand" style="font-size:.8125rem">Forgot password?</a>
        </div>

        <button class="btn btn--primary btn--lg btn--full" id="loginBtn">Sign In</button>

        <div class="auth-card__footer">Don't have an account? <a href="signup.html" data-page="signup.html">Create one</a></div>
      </div>
    </div>
  </div>
</section>

<footer style="text-align:center;padding:2rem 1rem;font-size:.75rem;color:var(--text-4)">
  <span>&copy; 2026 ALIN. All rights reserved.</span>
  <span style="margin:0 .5rem">·</span>
  <a href="privacy.html" class="link-brand" data-page="privacy.html">Privacy</a>
  <span style="margin:0 .5rem">·</span>
  <a href="terms.html" class="link-brand" data-page="terms.html">Terms</a>
</footer>

<script>
var loginBtn=document.getElementById('loginBtn');
var errorEl=document.getElementById('error');

function showError(msg){errorEl.textContent=msg;errorEl.classList.add('visible')}
function hideError(){errorEl.classList.remove('visible')}

loginBtn.addEventListener('click',function(){handleLogin()});

async function handleLogin(){
  var email=document.getElementById('email').value.trim();
  var password=document.getElementById('password').value;
  hideError();
  if(!email||!password){showError('Email and password are required.');return}
  loginBtn.textContent='Signing in...';loginBtn.disabled=true;
  try{
    var res=await fetch('/api/auth/login',{method:'POST',headers:{'Content-Type':'application/json'},body:JSON.stringify({email:email,password:password})});
    var data=await res.json();
    if(!res.ok)throw new Error(data.error||'Login failed');
    localStorage.setItem('alin-auth-storage',JSON.stringify({state:{user:data.user,token:data.token,isAuthenticated:true},version:0}));
    window.location.href='/app/chat';
  }catch(err){
    showError(err.message);
    loginBtn.textContent='Sign In';loginBtn.disabled=false;
  }
}

document.getElementById('password').addEventListener('keydown',function(e){if(e.key==='Enter')handleLogin()});

document.getElementById('togglePw').addEventListener('click',function(){
  var pw=document.getElementById('password');
  var icon=document.getElementById('eyeIcon');
  var show=pw.type==='password';
  pw.type=show?'text':'password';
  icon.innerHTML=show
    ?'<path d="M17.94 17.94A10.07 10.07 0 0 1 12 20c-7 0-11-8-11-8a18.45 18.45 0 0 1 5.06-5.94"/><path d="M9.9 4.24A9.12 9.12 0 0 1 12 4c7 0 11 8 11 8a18.5 18.5 0 0 1-2.16 3.19"/><line x1="1" y1="1" x2="23" y2="23"/>'
    :'<path d="M1 12s4-8 11-8 11 8 11 8-4 8-11 8-11-8-11-8z"/><circle cx="12" cy="12" r="3"/>';
});

initPage();
</script>
</body>
</html>
